# 入力CSVファイルの仕様

本スクリプトは、以下の形式のCSVファイルを想定しています。

## 1. エンコーディング

本スクリプトは、UTF-8エンコーディングのCSVファイルのみを想定しています。

**推奨:** 調整さんからUTF-8形式でエクスポートしてください。調整さんの「CSVダウンロード」機能には、Mac向けにUTF-8で出力するオプションがあります。このオプションを利用することで、文字化けのリスクを減らし、本スクリプトでの処理がより安定します。

### 文字コード指定の標準

PowerShellスクリプト内でエンコーディングを指定する際は、以下の標準に従います。

* **UTF-8:**
  * PowerShellのコード内で直接エンコーディングオブジェクトを使用する場合: `[System.Text.Encoding]::UTF8`
  * `パラメータ`として文字列で渡す場合、または `[System.Text.Encoding]::GetEncoding()` で取得する場合: `"utf-8"`（小文字、ハイフン）

## 2. CSV構造

**重要:** 本スクリプトが想定するCSV構造は、「調整さん」からエクスポートされるCSVファイルに特有のものです。一般的なCSVファイルとは異なり、**2行目が空行**である点に注意してください。

```csv
(1行目) ここにイベントの件名が入ります
(2行目) 
(3行目) 日程,参加者A,参加者B,参加者C
(4行目以降) 2025/08/01(金) 10:00〜,◯,△,×
2025/08/02(土) 11:00〜,◯,◯,◯
...
```

* **1行目:** カレンダーに登録されるイベントの **件名** になります。
* **2行目:** 空行です。
* **3行目:** ヘッダー行です。「日程」という列と、参加者名が続きます。
* **4行目以降:** 候補日と、各参加者の出欠（◯, △, ×）が入ります。
  * 年が省略された日付（例: `7/18(木) 20:00〜`）の場合、スクリプト実行時の現在年を補完します。補完された日付が現在の日付よりも過去になる場合、自動的に年を1年進めて「次の開催日」として扱います。

## 3. 技術的詳細と要件

* **デフォルトファイル:** スクリプトと同じディレクトリにある `chouseisan.csv` をデフォルトの入力ファイルとする。
* **エンコーディング:** UTF-8のみ対応。
* **テストデータ:** `chouseisan_shift-jis-dont-erase.csv` はShift-JISエンコーディングのテストデータとして利用されます。（現在はテスト対象外）
* **構造の詳細:**
  * 1行目: イベントの件名
  * 2行目: 空行
  * 3行目: ヘッダー行 (`日程`, `参加者1`, `参加者2`, ...)
  * 4行目以降: データ行 (`YYYY/MM/DD(ddd) HH:MM〜`, `◯`, `△`, `×`, ...)
* **オプション:**
  * `-CsvPath <String>`: 読み込むCSVファイルのパスを明示的に指定できる。
